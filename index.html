<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testes de Seguran√ßa AVAN√áADOS do Navegador do Console</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
            color: #333;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #cc0000; /* Vermelho para indicar testes mais s√©rios */
        }
        button {
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            background-color: #dc3545; /* Vermelho mais escuro para bot√µes de risco */
            color: white;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #c82333;
        }
        .refresh-button {
            background-color: #007bff; /* Azul para o bot√£o de refresh */
            margin-bottom: 20px;
        }
        .refresh-button:hover {
            background-color: #0056b3;
        }
        input[type="text"], input[type="number"] {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: calc(70% - 10px); /* Ajuste para espa√ßamento */
            box-sizing: border-box;
            margin-bottom: 5px;
        }
        textarea {
            width: 98%;
            height: 100px;
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        pre {
            background-color: #e2e2e2;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 200px;
            overflow-y: auto;
        }
        .result {
            margin-top: 10px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .error-message {
            color: red;
            font-weight: bold;
        }
        .success-message {
            color: green;
            font-weight: bold;
        }
        canvas {
            display: block;
            margin-top: 10px;
        }
        .test-area {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .test-result {
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="refresh-button" onclick="location.reload()">üîÑ Atualizar P√°gina</button>

        <h1>‚ö†Ô∏è Testes de Seguran√ßa AVAN√áADOS do Navegador do Console ‚ö†Ô∏è</h1>
        <p>Estes testes exploram cen√°rios mais agressivos e complexos no navegador do seu console. **Prossiga com cautela.**</p>

        ---

        <h2>1. Teste de Fragmenta√ß√£o de Mem√≥ria e Objetos Pesados</h2>
        <p>Cria e descarta muitos objetos complexos. Pode levar a lentid√£o ou travamentos se o coletor de lixo n√£o for eficiente.</p>
        <button onclick="startMemoryFragmentationTest()">Iniciar Teste</button>
        <button onclick="stopMemoryFragmentationTest()">Parar Teste</button>
        <div id="fragMemStatus" class="result">Status: Inativo</div>

        ---

        <h2>2. Teste de Carregamento de Recursos Excessivos/Inv√°lidos</h2>
        <p>Tenta carregar um n√∫mero absurdo de elementos HTML (imagens, divs) ou recursos inv√°lidos. Observar consumo de CPU/Mem√≥ria.</p>
        <input type="number" id="numElements" value="10000" min="1000" max="100000" step="1000">
        <button onclick="loadExcessiveElements()">Carregar Elementos HTML</button>
        <button onclick="loadInvalidImage()">Carregar Imagem Inv√°lida</button>
        <div id="excessiveLoadStatus" class="result">Status: Aguardando...</div>
        <div id="elementContainer"></div>

        ---

        <h2>3. Teste de Web Workers (Processamento em Segundo Plano)</h2>
        <p>Inicia um Web Worker para fazer c√°lculos pesados. Verifica se o navegador continua responsivo e se o worker √© isolado.</p>
        <button onclick="startWorkerStress()">Iniciar Worker Stress</button>
        <button onclick="stopWorkerStress()">Parar Worker Stress</button>
        <div id="workerStatus" class="result">Status: Inativo</div>

        ---

        <h2>4. Teste de Exaust√£o de Conex√µes de Rede (WebSockets)</h2>
        <p>Tenta abrir e manter um grande n√∫mero de conex√µes WebSocket. Pode esgotar limites de conex√£o do sistema.</p>
        <input type="number" id="numWebsockets" value="500" min="10" max="2000" step="10">
        <button onclick="startWebSocketExhaustion()">Iniciar Exaust√£o WS</button>
        <button onclick="closeAllWebSockets()">Fechar Todos WS</button>
        <div id="wsExhaustStatus" class="result">Status: Inativo</div>

        ---

        <h2>5. Teste de Iframe Sandbox Bypass</h2>
        <p>Carrega iframes com diferentes atributos de sandbox. Verifique se o conte√∫do do iframe pode quebrar o isolamento.</p>
        <button onclick="testIframeSandbox()">Testar Iframes</button>
        <div id="iframeSandboxStatus" class="result">Status: Aguardando...</div>

        ---

        <h2>6. Teste de Estresse Gr√°fico (Canvas Animado)</h2>
        <p>Desenha anima√ß√µes complexas em um canvas para estressar o motor de renderiza√ß√£o do navegador.</p>
        <button onclick="startGraphicsStress()">Iniciar Estresse Gr√°fico</button>
        <button onclick="stopGraphicsStress()">Parar Estresse Gr√°fico</button>
        <canvas id="graphicsCanvas" width="400" height="200" style="border: 1px solid black; background-color: #eee;"></canvas>
        <div id="graphicsStatus" class="result">Status: Inativo</div>

        ---

        <div class="test-area">
            <h2>7. Teste de Viola√ß√£o de Content Security Policy (CSP) - Imagem</h2>
            <p>Tenta carregar uma imagem de um dom√≠nio que provavelmente bloquearia por CSP (se implementado).</p>
            <img src="https://evil.example.com/image.png" width="1" height="1" onerror="this.style.visibility='visible'; this.alt='Falhou ao carregar (CSP?)'">
            <div class="test-result">Resultado: A imagem acima deveria falhar ao carregar se o CSP estiver bloqueando dom√≠nios externos. Se aparecer um "X" ou um texto alternativo, pode indicar um bloqueio.</div>
        </div>

        ---

        <div class="test-area">
            <h2>8. Teste de Viola√ß√£o de Content Security Policy (CSP) - Script (Inline)</h2>
            <p>Tenta executar um script inline (que pode ser bloqueado por CSP).</p>
            <script>
                // Este script provavelmente n√£o executar√° se o CSP for estrito e bloquear 'unsafe-inline'
                try {
                    console.log("Teste de script inline");
                    var cspTest = "Inline script tentou rodar.";
                    var resultElement = document.getElementById('csp-inline-result');
                    if (resultElement) {
                        resultElement.textContent = cspTest;
                    } else {
                        console.log(cspTest);
                    }
                } catch (e) {
                    console.error("Erro ao tentar executar script inline:", e);
                }
            </script>
            <div id="csp-inline-result" class="test-result">Resultado: Este texto deveria ser substitu√≠do se o script inline executar (improv√°vel com CSP estrito).</div>
        </div>

        ---

        <div class="test-area">
            <h2>9. Teste de URL Malformada</h2>
            <p>Tenta carregar uma imagem com uma URL intencionalmente malformada.</p>
            <img src="htp://inval!d-url:.com" width="1" height="1" onerror="this.style.visibility='visible'; this.alt='Falhou ao carregar (URL inv√°lida)'">
            <div class="test-result">Resultado: A imagem acima deve falhar ao carregar devido √† URL inv√°lida. Observe qualquer erro no navegador.</div>
        </div>

        ---

        <div class="test-area">
            <h2>10. Teste de Carregamento de 'file:///' URL (Acesso Local)</h2>
            <p>Tenta carregar um recurso usando o protocolo 'file:///'. Navegadores seguros geralmente bloqueiam isso por motivos de seguran√ßa.</p>
            <img src="file:///etc/passwd" width="1" height="1" onerror="this.style.visibility='visible'; this.alt='Falhou ao carregar (file:/// bloqueado)'">
            <div class="test-result">Resultado: A imagem acima DEVE falhar ao carregar. Se carregar (o que √© altamente improv√°vel), √© uma falha de seguran√ßa grave.</div>
        </div>

        ---

        <div class="test-area">
            <h2>11. Teste de Redirecionamento para Schema Inv√°lido</h2>
            <p><a href="inval!dschema:example">Clique aqui para tentar um redirecionamento para um schema inv√°lido.</a></p>
            <div class="test-result">Resultado: Clicar no link n√£o deve fazer nada ou deve exibir um erro do navegador sobre o schema inv√°lido.</div>
        </div>

        ---

        <div class="test-area">
            <h2>12. Teste de Iframe com Atributo 'srcdoc' (Sem Carregar URL Externa)</h2>
            <p>Carrega um iframe com conte√∫do diretamente no HTML (usando 'srcdoc'). Isso deve funcionar mesmo com restri√ß√µes de script externo.</p>
            <iframe width="300" height="100" style="border: 1px solid black;" srcdoc="&lt;html&gt;&lt;body&gt;&lt;h3&gt;Iframe Local&lt;/h3&gt;&lt;p&gt;Conte√∫do carregado diretamente.&lt;/p&gt;&lt;script&gt;console.log('Script dentro do srcdoc');&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;">
            </iframe>
            <div class="test-result">Resultado: O iframe acima deve carregar e exibir o texto "Iframe Local". O script dentro pode ou n√£o executar dependendo das restri√ß√µes.</div>
        </div>

        ---

        <h2>Resultados do Console (Log):</h2>
        <pre id="consoleLog"></pre>
    </div>

    <script>
        // Fun√ß√£o de log aprimorada
        const consoleLogElement = document.getElementById('consoleLog');
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            let color = 'black';
            if (type === 'error') color = 'red';
            if (type === 'success') color = 'green';
            if (consoleLogElement) {
                consoleLogElement.innerHTML += `<span style="color: ${color};">[${timestamp}] ${message}</span>\n`;
                consoleLogElement.scrollTop = consoleLogElement.scrollHeight;
            } else {
                console.log(`[${timestamp}] ${message}`);
            }
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            log('P√°gina carregada e JavaScript iniciado!', 'info');
        });

        // --- Teste 1: Teste de Fragmenta√ß√£o de Mem√≥ria e Objetos Pesados ---
        let fragMemInterval;
        let runningFragMemTest = false;
        let generatedObjects = [];

        function startMemoryFragmentationTest() {
            if (runningFragMemTest) {
                log('Teste Fragmenta√ß√£o de Mem√≥ria j√° est√° rodando.', 'info');
                return;
            }
            runningFragMemTest = true;
            document.getElementById('fragMemStatus').textContent = 'Status: Gerando e destruindo objetos... Observar lentid√£o.';
            log('Teste Frag. Mem√≥ria: Iniciando...', 'info');

            let counter = 0;
            fragMemInterval = setInterval(() => {
                try {
                    const bigObject = {
                        data: new Uint32Array(1024 * 1024 / 4), // 1MB de dados
                        metadata: {
                            id: counter++,
                            timestamp: Date.now(),
                            randomString: Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)
                        }
                    };
                    generatedObjects.push(bigObject);

                    if (generatedObjects.length > 200 && generatedObjects.length % 100 === 0) {
                        generatedObjects.splice(0, 50);
                        log(`Teste Frag. Mem√≥ria: Gerados ${counter} objetos, ${generatedObjects.length} ativos. For√ßando GC...`, 'info');
                    }
                    if (generatedObjects.length > 500) {
                        generatedObjects.splice(0, 100);
                    }
                    document.getElementById('fragMemStatus').textContent = `Status: Gerando e destruindo objetos... Total gerado: ${counter}`;

                } catch (e) {
                    log(`Teste Frag. Mem√≥ria: Erro durante a gera√ß√£o: ${e.message}. Parando teste.`, 'error');
                    stopMemoryFragmentationTest();
                }
            }, 50);
        }

        function stopMemoryFragmentationTest() {
            if (!runningFragMemTest) return;
            runningFragMemTest = false;
            clearInterval(fragMemInterval);
            generatedObjects = [];
            document.getElementById('fragMemStatus').textContent = 'Status: Parado. Mem√≥ria liberada.';
            log('Teste Frag. Mem√≥ria: Parado. Objetos liberados.', 'success');
        }

        // --- Teste 2: Teste de Carregamento de Recursos Excessivos/Inv√°lidos ---
        function loadExcessiveElements() {
            const numElements = parseInt(document.getElementById('numElements').value);
            const elementContainer = document.getElementById('elementContainer');
            const excessiveLoadStatus = document.getElementById('excessiveLoadStatus');
            elementContainer.innerHTML = '';
            log(`Teste Excesso de Elementos: Carregando ${numElements} elementos HTML...`, 'info');
            excessiveLoadStatus.textContent = `Status: Carregando ${numElements} elementos... (Pode travar)`;

            let count = 0;
            const startTime = Date.now();

            function addElementChunk() {
                try {
                    const fragment = document.createDocumentFragment();
                    for (let i = 0; i < 1000 && count < numElements; i++) {
                        const div = document.createElement('div');
                        div.style.width = '1px';
                        div.style.height = '1px';
                        div.style.backgroundColor = 'blue';
                        div.style.display = 'inline-block';
                        fragment.appendChild(div);
                        count++;
                    }
                    elementContainer.appendChild(fragment);

                    if (count < numElements) {
                        requestAnimationFrame(addElementChunk);
                    } else {
                        const endTime = Date.now();
                        log(`Teste Excesso de Elementos: Carregados ${numElements} elementos em ${endTime - startTime}ms.`, 'success');
                        excessiveLoadStatus.textContent = `Status: Carregados ${numElements} elementos. Observar consumo de recursos.`;
                    }
                    excessiveLoadStatus.textContent = `Status: Carregados ${count}/${numElements} elementos.`;
                } catch (e) {
                    log(`Teste Excesso de Elementos: Erro ao adicionar elementos: ${e.message}. Parando.`, 'error');
                    excessiveLoadStatus.textContent = `Status: ERRO ao carregar elementos: ${e.message}`;
                }
            }
            requestAnimationFrame(addElementChunk);
        }

        function loadInvalidImage() {
            const excessiveLoadStatus = document.getElementById('excessiveLoadStatus');
            const elementContainer = document.getElementById('elementContainer');
            elementContainer.innerHTML = '';

            log('Teste Imagem Inv√°lida: Tentando carregar imagem com dados corrompidos...', 'info');
            excessiveLoadStatus.textContent = 'Status: Tentando carregar imagem inv√°lida...';

            const img = new Image();
            img.onload = () => {
                log('Teste Imagem Inv√°lida: ATEN√á√ÉO! Imagem inv√°lida carregada com sucesso! Isso pode indicar falha no parser de imagem.', 'error');
                excessiveLoadStatus.textContent = 'Status: Imagem inv√°lida carregada (Problema!)';
                elementContainer.appendChild(img);
            };
            img.onerror = () => {
                log('Teste Imagem Inv√°lida: Falha ao carregar imagem inv√°lida. (Comportamento esperado)', 'success');
                excessiveLoadStatus.textContent = 'Status: Falha ao carregar imagem inv√°lida (OK)';
            };
            img.src = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBD';
        }

        // --- Teste 3: Teste de Web Workers (Processamento em Segundo Plano) ---
        let worker;
        let workerRunning = false;
        function startWorkerStress() {
            if (workerRunning) {
                log('Web Worker j√° est√° rodando.', 'info');
                return;
            }
            workerRunning = true;
            document.getElementById('workerStatus').textContent = 'Status: Iniciando Web Worker...';
            log('Teste Web Worker: Iniciando...', 'info');

            const workerScriptContent = `
                onmessage = function(e) {
                    if (e.data === 'start') {
                        let result = 0;
                        try {
                            for (let i = 0; i < 5000000000; i++) {
                                result += Math.sqrt(i);
                            }
                            postMessage('done');
                        } catch (err) {
                            postMessage({ type: 'error', message: err.message });
                        }
                    }
                };
            `;
            const blob = new Blob([workerScriptContent], { type: 'application/javascript' });
            worker = new Worker(URL.createObjectURL(blob));

            worker.onmessage = (e) => {
                if (e.data === 'done') {
                    document.getElementById('workerStatus').textContent = 'Status: Web Worker terminou o processamento pesado.';
                    log('Teste Web Worker: Processamento pesado conclu√≠do pelo worker.', 'success');
                    workerRunning = false;
                    worker.terminate();
                } else if (e.data.type === 'error') {
                    document.getElementById('workerStatus').textContent = `Status: Erro no Web Worker: ${e.data.message}`;
                    log(`Teste Web Worker: Erro no worker: ${e.data.message}.`, 'error');
                    workerRunning = false;
                    worker.terminate();
                }
            };
            worker.onerror = (e) => {
                document.getElementById('workerStatus').textContent = `Status: Erro fatal no Web Worker: ${e.message}`;
                log(`Teste Web Worker: Erro FATAL no worker: ${e.message}.`, 'error');
                workerRunning = false;
            };

            worker.postMessage('start');
            document.getElementById('workerStatus').textContent = 'Status: Web Worker rodando c√°lculo pesado. Navegador deve permanecer responsivo.';
        }

        function stopWorkerStress() {
            if (!workerRunning) return;
            log('Teste Web Worker: Solicitando parada (pode n√£o parar imediatamente se o c√°lculo for muito pesado)...', 'info');
            if (worker) {
                worker.terminate();
                workerRunning = false;
                document.getElementById('workerStatus').textContent = 'Status: Web Worker parado (terminado).';
                log('Teste Web Worker: Worker terminado.', 'success');
            }
        }

        // --- Teste 4: Teste de Exaust√£o de Conex√µes de Rede (WebSockets) ---
        let activeWebSockets = [];
        let wsExhaustionRunning = false;
        function startWebSocketExhaustion() {
            if (wsExhaustionRunning) {
                log('Teste Exaust√£o de WS j√° est√° rodando.', 'info');
                return;
            }
            wsExhaustionRunning = true;
            const numWebsockets = parseInt(document.getElementById('numWebsockets').value);
            const wsExhaustStatus = document.getElementById('wsExhaustStatus');
            wsExhaustStatus.textContent = `Status: Abrindo ${numWebsockets} WebSockets...`;
            log(`Teste Exaust√£o WS: Tentando abrir ${numWebsockets} conex√µes...`, 'info');

            activeWebSockets = [];
            let openedCount = 0;
            let errorCount = 0;
            let closedCount = 0;

            const targetWsUrl = 'ws://echo.websocket.events';

            for (let i = 0; i < numWebsockets; i++) {
                try {
                    const ws = new WebSocket(targetWsUrl);
                    activeWebSockets.push(ws);

                    ws.onopen = () => {
                        openedCount++;
                        updateWsExhaustStatus();
                    };
                    ws.onerror = (e) => {
                        errorCount++;
                        updateWsExhaustStatus();
                    };
                    ws.onclose = () => {
                        closedCount++;
                        updateWsExhaustStatus();
                    };
                } catch (e) {
                    errorCount++;
                    log(`Teste Exaust√£o WS: Erro ao iniciar WS ${i}: ${e.message}`, 'error');
                }
            }
            log(`Teste Exaust√£o WS: Tentativa de abrir ${numWebsockets} WebSockets conclu√≠da.`, 'success');

            function updateWsExhaustStatus() {
                wsExhaustStatus.textContent = `Status: Tentando abrir ${numWebsockets}. Abertas: ${openedCount}. Fechadas: ${closedCount}. Erros: ${errorCount}.`;
            }
        }

        function closeAllWebSockets() {
            if (!wsExhaustionRunning) return;
            log('Teste Exaust√£o WS: Fechando todas as conex√µes WebSocket...', 'info');
            activeWebSockets.forEach(ws => {
                if (ws.readyState === WebSocket.OPEN || ws.readyState === WebSocket.CONNECTING) {
                    ws.close();
                }
            });
            activeWebSockets = [];
            wsExhaustionRunning = false;
            document.getElementById('wsExhaustStatus').textContent = 'Status: Todas as conex√µes WebSocket fechadas.';
            log('Teste Exaust√£o WS: Todas as conex√µes fechadas.', 'success');
        }

        // --- Teste 5: Teste de Iframe Sandbox Bypass ---
        function testIframeSandbox() {
            const iframeSandboxStatus = document.getElementById('iframeSandboxStatus');
            iframeSandboxStatus.innerHTML = 'Status: Iniciando testes de iframe sandbox...<br>';
            log('Teste Iframe Sandbox: Iniciando...', 'info');

            const testConfigs = [
                { id: 'iframe1', title: 'Nenhum Sandbox (Perigoso)', sandbox: '' },
                { id: 'iframe2', title: 'Sandbox Sem Scripts (Esperado que falhe alerta)', sandbox: 'allow-forms allow-modals allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-top-navigation-by-user-activation' },
                { id: 'iframe3', title: 'Sandbox Com Scripts (Esperado que mostre alerta)', sandbox: 'allow-scripts allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-top-navigation-by-user-activation' }
            ];

            testConfigs.forEach(config => {
                const iframe = document.createElement('iframe');
                iframe.id = config.id;
                iframe.width = '300';
                iframe.height = '100';
                iframe.style.border = '1px solid black';
                iframe.sandbox = config.sandbox;
                iframe.srcdoc = `
                    <!DOCTYPE html>
                    <html>
                    <head><title>${config.title}</title></head>
                    <body>
                        <h3>${config.title}</h3>
                        <p id="message">Teste...</p>
                        <script>
                            try {
                                if (window.parent !== window) {
                                    document.getElementById('message').textContent += ' | Acesso ao parent OK.';
                                } else {
                                    document.getElementById('message').textContent += ' | Acesso ao parent BLOQUEADO (Esperado com sandbox).';
                                }
                                setTimeout(() => { alert('${config.title} - Script Executado!'); }, 500);
                                document.getElementById('message').textContent += ' | Alerta agendado.';
                            } catch (e) {
                                document.getElementById('message').textContent += ' | Erro no script: ' + e.message;
                            }
                        </script>
                    </body>
                    </html>
                `;

                iframe.onload = () => {
                    log(`Iframe ${config.title}: Carregado.`, 'info');
                    try {
                        const iframeDoc = iframe.contentWindow.document;
                        const messageElement = iframeDoc.getElementById('message');
                        log(`Iframe ${config.title}: Mensagem interna: "${messageElement ? messageElement.textContent : 'N√£o acess√≠vel'}"`, 'info');
                    } catch (e) {
                        log(`Iframe ${config.title}: Bloqueado pelo Same-Origin Policy (esperado para sandbox sem allow-same-origin). Erro: ${e.message}`, 'success');
                    }
                };
                iframe.onerror = () => {
                    log(`Iframe ${config.title}: Erro ao carregar.`, 'error');
                };

                document.getElementById('iframeSandboxStatus').appendChild(iframe);
                document.getElementById('iframeSandboxStatus').innerHTML += `<br>`;
            });
            log('Teste Iframe Sandbox: Testes iniciados. Observe os comportamentos dos iframes.', 'success');
        }

        // --- Teste 6: Teste de Estresse Gr√°fico (Canvas Animado) ---
        let animationFrameId;
        let isGraphicsStressRunning = false;
        function startGraphicsStress() {
            if (isGraphicsStressRunning) return;
            isGraphicsStressRunning = true;

            const canvas = document.getElementById('graphicsCanvas');
            const ctx = canvas.getContext('2d');
            const graphicsStatus = document.getElementById('graphicsStatus');
            log('Teste Gr√°fico: Iniciando estresse gr√°fico...', 'info');
            graphicsStatus.textContent = 'Status: Rodando... (Observar desempenho e estabilidade)';

            let angle = 0;
            const draw = () => {
                try {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    for (let i = 0; i < 50; i++) {
                        const x = canvas.width / 2 + Math.cos(angle + i * 0.1) * (100 + i * 0.5);
                        const y = canvas.height / 2 + Math.sin(angle + i * 0.1) * (50 + i * 0.2);
                        const radius = 5 + Math.sin(angle * 0.5 + i * 0.2) * 3;

                        ctx.beginPath();
                        ctx.arc(x, y, radius, 0, Math.PI * 2);
                        ctx.fillStyle = `hsl(${angle * 10 % 360}, 70%, 50%)`;
                        ctx.fill();
                    }

                    angle += 0.05;
                    animationFrameId = requestAnimationFrame(draw);
                } catch (e) {
                    log(`Teste Gr√°fico: Erro durante a renderiza√ß√£o: ${e.message}. Parando.`, 'error');
                    stopGraphicsStress();
                }
            };

            animationFrameId = requestAnimationFrame(draw);
        }

        function stopGraphicsStress() {
            if (!isGraphicsStressRunning) return;
            isGraphicsStressRunning = false;
            cancelAnimationFrame(animationFrameId);
            document.getElementById('graphicsStatus').textContent = 'Status: Inativo';
            log('Teste Gr√°fico: Estresse gr√°fico parado.', 'info');
        }
    </script>
</body>
</html>
